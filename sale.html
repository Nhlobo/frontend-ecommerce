<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sale & Special Offers - Up to 40% OFF on Premium Hair Wigs & Extensions. Limited time deals on luxury wigs, extensions, and accessories. Shop now!">
    <meta name="keywords" content="hair wigs sale, extensions discount, wig deals, hair products sale, special offers, South Africa">
    <meta name="author" content="Premium Hair Wigs & Extensions Pty (Ltd)">
    <title>Sale & Special Offers - Premium Hair Wigs & Extensions | Up to 40% OFF</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="components.css">
    <link rel="stylesheet" href="responsive.css">
    
    <style>
        .sale-hero {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
            padding: 4rem 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .sale-hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 500px;
            height: 500px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .sale-hero::after {
            content: '';
            position: absolute;
            bottom: -30%;
            left: -5%;
            width: 400px;
            height: 400px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .sale-hero-content {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .sale-badge {
            display: inline-block;
            background: #ffc107;
            color: #333;
            padding: 0.75rem 2rem;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 1.5rem;
            animation: pulse 2s infinite;
        }

        .sale-hero h1 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 3.5rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .sale-hero p {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            opacity: 0.95;
        }

        .countdown-container {
            background: rgba(0, 0, 0, 0.3);
            padding: 2rem;
            border-radius: 15px;
            max-width: 600px;
            margin: 0 auto;
            backdrop-filter: blur(10px);
        }

        .countdown-label {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            opacity: 0.9;
        }

        .countdown-timer {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
        }

        .countdown-item {
            text-align: center;
        }

        .countdown-value {
            display: block;
            font-size: 3rem;
            font-weight: 700;
            line-height: 1;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .countdown-unit {
            display: block;
            font-size: 0.9rem;
            text-transform: uppercase;
            opacity: 0.8;
        }

        .sale-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 3rem 1rem;
        }

        .sale-controls {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .sale-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 1rem;
        }

        .sale-tab {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            color: #6c757d;
            transition: all 0.3s;
            position: relative;
        }

        .sale-tab:hover {
            color: #dc3545;
            background: rgba(220, 53, 69, 0.05);
        }

        .sale-tab.active {
            color: #dc3545;
            background: rgba(220, 53, 69, 0.1);
        }

        .sale-tab.active::after {
            content: '';
            position: absolute;
            bottom: -0.6rem;
            left: 0;
            right: 0;
            height: 3px;
            background: #dc3545;
        }

        .sort-filter {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .sort-filter label {
            font-weight: 500;
            color: #333;
        }

        .sort-filter select {
            padding: 0.75rem 1rem;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
        }

        .sort-filter select:focus {
            outline: none;
            border-color: #dc3545;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
        }

        .product-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
            position: relative;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
        }

        .product-image-container {
            position: relative;
            overflow: hidden;
            padding-top: 100%;
        }

        .product-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .discount-badge {
            position: absolute;
            top: 1rem;
            left: 1rem;
            background: #dc3545;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1rem;
            z-index: 1;
            box-shadow: 0 2px 10px rgba(220, 53, 69, 0.4);
        }

        .limited-stock-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: #ffc107;
            color: #333;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-weight: 600;
            font-size: 0.85rem;
            z-index: 1;
            animation: blink 1.5s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .product-wishlist {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 40px;
            height: 40px;
            background: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2;
            transition: all 0.3s;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .product-wishlist:hover {
            transform: scale(1.1);
            background: #dc3545;
            color: white;
        }

        .product-wishlist.active {
            background: #dc3545;
            color: white;
        }

        .product-info {
            padding: 1.5rem;
        }

        .product-category {
            color: #6c757d;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .product-name {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.25rem;
            color: #333;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .product-prices {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .original-price {
            font-size: 1rem;
            color: #6c757d;
            text-decoration: line-through;
        }

        .sale-price {
            font-size: 1.5rem;
            color: #dc3545;
            font-weight: 700;
        }

        .savings {
            background: #d4edda;
            color: #155724;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .product-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .stars {
            color: #ffc107;
        }

        .rating-count {
            color: #6c757d;
            font-size: 0.875rem;
        }

        .product-actions {
            display: flex;
            gap: 0.75rem;
        }

        .btn-add-cart {
            flex: 1;
            padding: 0.875rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn-add-cart:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 69, 19, 0.3);
        }

        .btn-quick-view {
            padding: 0.875rem 1rem;
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-quick-view:hover {
            background: var(--primary);
            color: white;
        }

        .newsletter-banner {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 3rem 2rem;
            border-radius: 15px;
            text-align: center;
            margin-top: 3rem;
        }

        .newsletter-banner h2 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .newsletter-banner p {
            font-size: 1.1rem;
            margin-bottom: 2rem;
            opacity: 0.95;
        }

        .newsletter-form {
            display: flex;
            gap: 1rem;
            max-width: 500px;
            margin: 0 auto;
            flex-wrap: wrap;
            justify-content: center;
        }

        .newsletter-form input {
            flex: 1;
            min-width: 250px;
            padding: 1rem 1.5rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .newsletter-form input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .newsletter-form input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.2);
            border-color: white;
        }

        .newsletter-form button {
            padding: 1rem 2.5rem;
            background: white;
            color: var(--primary);
            border: none;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .newsletter-form button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        @media (max-width: 768px) {
            .sale-hero h1 {
                font-size: 2.5rem;
            }

            .countdown-timer {
                gap: 1rem;
            }

            .countdown-value {
                font-size: 2rem;
            }

            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 1.5rem;
            }

            .newsletter-form {
                flex-direction: column;
            }

            .newsletter-form input,
            .newsletter-form button {
                width: 100%;
            }
        }

        @media (max-width: 576px) {
            .sale-hero h1 {
                font-size: 2rem;
            }

            .countdown-value {
                font-size: 1.5rem;
            }

            .products-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="banner">
        Free Shipping on Orders Above R1,500
    </div>

    <nav>
        <div class="logo">
            <img src="assets/images/logo.png" alt="Company Logo" class="logo-image" onerror="this.style.display='none';">
        </div>

        <div class="hamburger" id="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>

        <ul class="nav-links" id="navLinks">
            <li><a href="index.html">Home</a></li>
            <li><a href="shop.html">Shop</a></li>
            <li><a href="about.html">About Us</a></li>
            <li><a href="sale.html" class="active">Sale</a></li>
            <li><a href="contact.html">Contact</a></li>
        </ul>

        <div class="nav-actions">
            <a href="cart.html" class="nav-icon">
                <i class="fas fa-shopping-cart"></i>
                <span class="cart-count" id="cartCount">0</span>
            </a>
            <a href="wishlist.html" class="nav-icon">
                <i class="fas fa-heart"></i>
            </a>
            <a href="account.html" class="nav-icon">
                <i class="fas fa-user"></i>
            </a>
        </div>
    </nav>

    <div class="sale-hero">
        <div class="sale-hero-content">
            <span class="sale-badge">üî• LIMITED TIME OFFER</span>
            <h1>Mega Sale Event</h1>
            <p>Up to 40% OFF on Premium Wigs & Extensions</p>
            
            <div class="countdown-container">
                <div class="countdown-label">‚è∞ Sale Ends In:</div>
                <div class="countdown-timer">
                    <div class="countdown-item">
                        <span class="countdown-value" id="days">00</span>
                        <span class="countdown-unit">Days</span>
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-value" id="hours">00</span>
                        <span class="countdown-unit">Hours</span>
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-value" id="minutes">00</span>
                        <span class="countdown-unit">Minutes</span>
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-value" id="seconds">00</span>
                        <span class="countdown-unit">Seconds</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="sale-container">
        <div class="sale-controls">
            <div class="sale-tabs">
                <button class="sale-tab active" data-category="all" onclick="filterByCategory('all')">
                    All Sale Items
                </button>
                <button class="sale-tab" data-category="wigs" onclick="filterByCategory('wigs')">
                    Wigs
                </button>
                <button class="sale-tab" data-category="extensions" onclick="filterByCategory('extensions')">
                    Extensions
                </button>
                <button class="sale-tab" data-category="accessories" onclick="filterByCategory('accessories')">
                    Accessories
                </button>
            </div>

            <div class="sort-filter">
                <label for="sortSelect">Sort By:</label>
                <select id="sortSelect" onchange="sortProducts()">
                    <option value="discount-high">Biggest Discount</option>
                    <option value="price-low">Price: Low to High</option>
                    <option value="price-high">Price: High to Low</option>
                    <option value="newest">Newest First</option>
                </select>
            </div>
        </div>

        <div class="products-grid" id="productsGrid">
            <!-- Products will be loaded here -->
        </div>

        <div class="newsletter-banner">
            <h2>Get Exclusive Sale Alerts</h2>
            <p>Subscribe to our newsletter and be the first to know about flash sales and special discounts!</p>
            <form class="newsletter-form" id="newsletterForm">
                <input 
                    type="email" 
                    id="newsletterEmail" 
                    placeholder="Enter your email address" 
                    required>
                <button type="submit">
                    <i class="fas fa-envelope"></i> Subscribe Now
                </button>
            </form>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>Premium Hair Wigs & Extensions</h3>
                <p>Premium Hair Wigs & Extensions Pty (Ltd)</p>
                <p>CIPC & VAT Registered</p>
                <p>POPIA Compliant</p>
                <div class="social-links">
                    <a href="https://facebook.com/premiumhairsa" target="_blank"><i class="fab fa-facebook-f"></i></a>
                    <a href="https://instagram.com/premiumhairsa" target="_blank"><i class="fab fa-instagram"></i></a>
                    <a href="https://twitter.com/premiumhairsa" target="_blank"><i class="fab fa-twitter"></i></a>
                    <a href="https://wa.me/27715551234" target="_blank"><i class="fab fa-whatsapp"></i></a>
                </div>
            </div>
            
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="shop.html">Shop All</a></li>
                    <li><a href="sale.html">Sale</a></li>
                    <li><a href="orders.html">My Orders</a></li>
                    <li><a href="about.html">About Us</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h3>Customer Service</h3>
                <ul>
                    <li><a href="#">Shipping Information</a></li>
                    <li><a href="#">Returns & Exchanges</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                    <li><a href="#">Terms & Conditions</a></li>
                    <li><a href="#">FAQ</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h3>Contact Us</h3>
                <p>üìç 123 Luxury Lane, Protea Glen<br>Soweto, Johannesburg, Gauteng, 1818</p>
                <p>üìû +27 71 555 1234</p>
                <p>‚úâÔ∏è info@premiumhairsa.co.za</p>
                <p><strong>Hours:</strong><br>Mon-Fri: 09:00-18:00<br>Sat: 09:00-14:00</p>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2024 Premium Hair Wigs & Extensions Pty (Ltd). All rights reserved. | CIPC Registered | VAT Registered | POPIA Compliant</p>
        </div>
    </footer>

    <script src="js/config.js"></script>
    <script src="js/security.js"></script>
    <script src="js/utils.js"></script>
    <script>
        // Mock sale products
        const saleProducts = [
            {
                id: 1,
                name: 'Brazilian Curly Wig',
                category: 'wigs',
                originalPrice: 2500.00,
                salePrice: 1500.00,
                discount: 40,
                image: 'assets/images/products/wig1.jpg',
                rating: 4.5,
                reviews: 128,
                stock: 5,
                limitedStock: true
            },
            {
                id: 2,
                name: 'Lace Front Wig HD',
                category: 'wigs',
                originalPrice: 2200.00,
                salePrice: 1540.00,
                discount: 30,
                image: 'assets/images/products/wig2.jpg',
                rating: 4.8,
                reviews: 95,
                stock: 12,
                limitedStock: false
            },
            {
                id: 3,
                name: 'Silk Press Extensions',
                category: 'extensions',
                originalPrice: 1200.00,
                salePrice: 840.00,
                discount: 30,
                image: 'assets/images/products/ext1.jpg',
                rating: 4.6,
                reviews: 73,
                stock: 8,
                limitedStock: false
            },
            {
                id: 4,
                name: 'Clip-in Extensions Set',
                category: 'extensions',
                originalPrice: 950.00,
                salePrice: 570.00,
                discount: 40,
                image: 'assets/images/products/ext2.jpg',
                rating: 4.4,
                reviews: 56,
                stock: 3,
                limitedStock: true
            },
            {
                id: 5,
                name: 'Premium Wig Cap',
                category: 'accessories',
                originalPrice: 150.00,
                salePrice: 105.00,
                discount: 30,
                image: 'assets/images/products/cap1.jpg',
                rating: 4.3,
                reviews: 201,
                stock: 25,
                limitedStock: false
            },
            {
                id: 6,
                name: 'Wig Adhesive Kit',
                category: 'accessories',
                originalPrice: 250.00,
                salePrice: 150.00,
                discount: 40,
                image: 'assets/images/products/adhesive1.jpg',
                rating: 4.7,
                reviews: 142,
                stock: 15,
                limitedStock: false
            },
            {
                id: 7,
                name: 'Body Wave Wig',
                category: 'wigs',
                originalPrice: 2800.00,
                salePrice: 1960.00,
                discount: 30,
                image: 'assets/images/products/wig3.jpg',
                rating: 4.9,
                reviews: 167,
                stock: 6,
                limitedStock: true
            },
            {
                id: 8,
                name: 'Ponytail Extension',
                category: 'extensions',
                originalPrice: 800.00,
                salePrice: 560.00,
                discount: 30,
                image: 'assets/images/products/ext3.jpg',
                rating: 4.5,
                reviews: 89,
                stock: 11,
                limitedStock: false
            }
        ];

        let currentProducts = [...saleProducts];
        let wishlist = JSON.parse(localStorage.getItem('wishlist') || '[]');

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            startCountdown();
            renderProducts();
            updateCartCount();
        });

        // Countdown timer
        function startCountdown() {
            const endDate = new Date();
            endDate.setDate(endDate.getDate() + 3); // 3 days from now
            endDate.setHours(23, 59, 59, 999);

            function updateCountdown() {
                const now = new Date().getTime();
                const distance = endDate - now;

                if (distance < 0) {
                    document.querySelector('.countdown-container').innerHTML = 
                        '<h3 style="color: white;">Sale Has Ended</h3>';
                    return;
                }

                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                document.getElementById('days').textContent = String(days).padStart(2, '0');
                document.getElementById('hours').textContent = String(hours).padStart(2, '0');
                document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
                document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');
            }

            updateCountdown();
            setInterval(updateCountdown, 1000);
        }

        // Render products
        function renderProducts() {
            const grid = document.getElementById('productsGrid');
            
            if (currentProducts.length === 0) {
                grid.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
                        <i class="fas fa-shopping-bag" style="font-size: 4rem; color: #dee2e6; margin-bottom: 1rem;"></i>
                        <h3>No sale items found</h3>
                        <p style="color: #6c757d;">Try changing your filters</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = currentProducts.map(product => {
                const isWishlisted = wishlist.includes(product.id);
                const savings = product.originalPrice - product.salePrice;
                
                return `
                    <div class="product-card">
                        <div class="product-image-container">
                            <img src="${product.image}" alt="${product.name}" class="product-image" onerror="this.src='assets/images/placeholder.jpg'">
                            <span class="discount-badge">-${product.discount}%</span>
                            ${product.limitedStock ? '<span class="limited-stock-badge">‚ö° Limited Stock!</span>' : ''}
                            <button class="product-wishlist ${isWishlisted ? 'active' : ''}" onclick="toggleWishlist(${product.id})">
                                <i class="fas fa-heart"></i>
                            </button>
                        </div>
                        <div class="product-info">
                            <div class="product-category">${product.category}</div>
                            <h3 class="product-name">${product.name}</h3>
                            
                            <div class="product-prices">
                                <span class="original-price">R${product.originalPrice.toFixed(2)}</span>
                                <span class="sale-price">R${product.salePrice.toFixed(2)}</span>
                            </div>
                            
                            <div class="savings">Save R${savings.toFixed(2)}</div>
                            
                            <div class="product-rating">
                                <div class="stars">
                                    ${generateStars(product.rating)}
                                </div>
                                <span class="rating-count">(${product.reviews})</span>
                            </div>
                            
                            ${product.limitedStock ? `
                                <div style="color: #dc3545; font-size: 0.875rem; margin-bottom: 1rem; font-weight: 600;">
                                    <i class="fas fa-exclamation-circle"></i> Only ${product.stock} left!
                                </div>
                            ` : ''}
                            
                            <div class="product-actions">
                                <button class="btn-add-cart" onclick="addToCart(${product.id})">
                                    <i class="fas fa-shopping-cart"></i> Add to Cart
                                </button>
                                <button class="btn-quick-view" onclick="viewProduct(${product.id})">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Generate stars
        function generateStars(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
            
            let stars = '';
            for (let i = 0; i < fullStars; i++) {
                stars += '<i class="fas fa-star"></i>';
            }
            if (hasHalfStar) {
                stars += '<i class="fas fa-star-half-alt"></i>';
            }
            for (let i = 0; i < emptyStars; i++) {
                stars += '<i class="far fa-star"></i>';
            }
            return stars;
        }

        // Filter by category
        function filterByCategory(category) {
            // Update active tab
            document.querySelectorAll('.sale-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // Filter products
            if (category === 'all') {
                currentProducts = [...saleProducts];
            } else {
                currentProducts = saleProducts.filter(p => p.category === category);
            }

            renderProducts();
        }

        // Sort products
        function sortProducts() {
            const sortBy = document.getElementById('sortSelect').value;

            switch (sortBy) {
                case 'discount-high':
                    currentProducts.sort((a, b) => b.discount - a.discount);
                    break;
                case 'price-low':
                    currentProducts.sort((a, b) => a.salePrice - b.salePrice);
                    break;
                case 'price-high':
                    currentProducts.sort((a, b) => b.salePrice - a.salePrice);
                    break;
                case 'newest':
                    currentProducts.sort((a, b) => b.id - a.id);
                    break;
            }

            renderProducts();
        }

        // Toggle wishlist
        function toggleWishlist(productId) {
            const index = wishlist.indexOf(productId);
            
            if (index > -1) {
                wishlist.splice(index, 1);
            } else {
                wishlist.push(productId);
            }
            
            localStorage.setItem('wishlist', JSON.stringify(wishlist));
            renderProducts();
        }

        // Add to cart
        function addToCart(productId) {
            const product = saleProducts.find(p => p.id === productId);
            if (!product) return;

            let cart = JSON.parse(localStorage.getItem('cart') || '[]');
            const existingItem = cart.find(item => item.id === productId);

            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({
                    id: product.id,
                    name: product.name,
                    price: product.salePrice,
                    originalPrice: product.originalPrice,
                    quantity: 1,
                    image: product.image
                });
            }

            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();

            // Show feedback
            alert(`${product.name} added to cart!`);
        }

        // View product
        function viewProduct(productId) {
            window.location.href = `product.html?id=${productId}`;
        }

        // Update cart count
        function updateCartCount() {
            const cart = JSON.parse(localStorage.getItem('cart') || '[]');
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCount').textContent = count;
        }

        // Newsletter form
        document.getElementById('newsletterForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('newsletterEmail').value;
            
            // Sanitize email
            const sanitizedEmail = email.trim().toLowerCase();
            
            // Save to localStorage
            let subscribers = JSON.parse(localStorage.getItem('newsletter_subscribers') || '[]');
            if (!subscribers.includes(sanitizedEmail)) {
                subscribers.push(sanitizedEmail);
                localStorage.setItem('newsletter_subscribers', JSON.stringify(subscribers));
                alert('Thank you for subscribing! You\'ll receive exclusive sale alerts.');
                document.getElementById('newsletterEmail').value = '';
            } else {
                alert('You\'re already subscribed to our newsletter!');
            }
        });

        // Mobile menu toggle
        document.getElementById('hamburger').addEventListener('click', () => {
            document.getElementById('navLinks').classList.toggle('active');
        });
    </script>
</body>
</html>
